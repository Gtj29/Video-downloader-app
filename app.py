from flask import Flask, render_template, request import yt_dlp app = Flask(__name__) @app.route('/') def index(): return render_template('index.html') @app.route('/download', methods=['POST']) def download(): url = request.form.get('url') if not url: return render_template('index.html', error='URL is required.') ydl_opts = { 'format': 'best', 'noplaylist': True, 'quiet': True, } try: with yt_dlp.YoutubeDL(ydl_opts) as ydl: info_dict = ydl.extract_info(url, download=False) video_title = info_dict.get('title', 'No Title') thumbnail = info_dict.get('thumbnail', None) formats = info_dict.get('formats', []) download_links = [] for f in formats: # Pastikan format memiliki video dan audio if f.get('vcodec') != 'none' and f.get('acodec') != 'none': resolution = f.get('format_note') or f.get('resolution') if not resolution: resolution = f"Default Quality" download_links.append({ 'url': f.get('url'), 'resolution': resolution, 'ext': f.get('ext') }) # Hapus link duplikat berdasarkan resolusi unique_links = [] seen_resolutions = set() for link in download_links: if link['resolution'] not in seen_resolutions: unique_links.append(link) seen_resolutions.add(link['resolution']) return render_template( 'index.html', title=video_title, thumbnail=thumbnail, links=unique_links ) except Exception as e: # Sederhanakan pesan error untuk pengguna error_message = f"An error occurred. It's possible the video is private, from a region-locked country, or the URL is not supported. (Details: {str(e)})" return render_template('index.html', error=error_message) if __name__ == '__main__': app.run(host='0.0.0.0', port=8080)
